---
phase: 01-foundation-stack-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - web/templates/base.html
  - web/static/css/tailwind-input.css
  - tailwind.config.js
  - scripts/build_css.sh
autonomous: false
---

<objective>
## Goal
Integrer Tailwind CSS (standalone CLI) et Alpine.js dans le projet Django, creer le template de base avec heritage, et migrer la palette observatory dark theme vers la configuration Tailwind.

## Purpose
Poser les fondations techniques pour la modernisation UI. Sans cette base, aucune page ne peut etre migree vers le nouveau stack.

## Output
- `web/templates/base.html` — Template de base Django avec Tailwind + Alpine.js
- `tailwind.config.js` — Configuration avec palette observatory custom
- `web/static/css/tailwind-input.css` — Fichier source Tailwind
- `web/static/css/tailwind-output.css` — CSS compile (genere)
- `scripts/build_css.sh` — Script de build Tailwind
</objective>

<context>
## Project Context
@.paul/PROJECT.md
@.paul/ROADMAP.md
@.paul/STATE.md

## Source Files
@web/driftapp_web/settings.py
@web/templates/dashboard.html (reference pour la palette actuelle)
@web/static/css/dashboard.css (CSS variables actuelles a migrer)
</context>

<skills>
## Required Skills (from SPECIAL-FLOWS.md)

| Skill | Priority | When to Invoke | Loaded? |
|-------|----------|----------------|---------|
| /frontend-design | required | Avant creation du base template HTML | ○ |

## Skill Invocation Checklist
- [ ] /frontend-design loaded (run command or confirm)
</skills>

<acceptance_criteria>

## AC-1: Tailwind CSS est integre et compile
```gherkin
Given le projet Django avec le fichier tailwind.config.js
When on execute scripts/build_css.sh
Then le fichier web/static/css/tailwind-output.css est genere sans erreur
And il contient les classes utilitaires Tailwind
```

## AC-2: Alpine.js est disponible dans les templates
```gherkin
Given le template base.html charge Alpine.js via CDN
When une page herite de base.html
Then les directives Alpine (x-data, x-show, x-on) fonctionnent
```

## AC-3: Template de base avec heritage Django
```gherkin
Given le fichier web/templates/base.html existe
When une page utilise {% extends "base.html" %}
Then le header, la navigation et le footer sont herites
And la page peut definir son contenu via {% block content %}
```

## AC-4: Palette observatory migree vers Tailwind config
```gherkin
Given tailwind.config.js definit les couleurs custom (bg-dark, accent-amber, etc.)
When on utilise class="bg-observatory-dark text-observatory-primary"
Then les couleurs correspondent a la palette actuelle (--bg-dark: #1a1612, etc.)
```

</acceptance_criteria>

<tasks>

<task type="auto">
  <name>Task 1: Setup Tailwind CSS standalone CLI + configuration</name>
  <files>tailwind.config.js, web/static/css/tailwind-input.css, scripts/build_css.sh</files>
  <action>
    1. Telecharger Tailwind CSS standalone CLI pour Linux:
       curl -sLO https://github.com/tailwindlabs/tailwindcss/releases/latest/download/tailwindcss-linux-x64
       chmod +x tailwindcss-linux-x64
       mv tailwindcss-linux-x64 tailwindcss

    2. Creer tailwind.config.js a la racine du projet:
       - content: ["./web/templates/**/*.html", "./web/static/js/**/*.js"]
       - theme.extend.colors: migrer TOUTE la palette CSS variables actuelle:
         observatory: {
           dark: '#1a1612',
           panel: '#241e18',
           input: '#2d261e',
           border: '#4a3d2e',
         }
         text: {
           primary: '#e8e4df',
           secondary: '#a09080',
         }
         accent: {
           amber: '#d4a055',
           green: '#00d26a',
           orange: '#ffa502',
           red: '#ff4757',
           purple: '#a855f7',
         }
       - Ajouter les font-family si besoin

    3. Creer web/static/css/tailwind-input.css:
       @tailwind base;
       @tailwind components;
       @tailwind utilities;
       + styles de base (body background, font defaults)

    4. Creer scripts/build_css.sh:
       #!/bin/bash
       ./tailwindcss -i web/static/css/tailwind-input.css -o web/static/css/tailwind-output.css --minify
       Mode watch: ./tailwindcss -i ... -o ... --watch

    5. Ajouter tailwindcss et web/static/css/tailwind-output.css au .gitignore

    Avoid: Ne PAS utiliser npm/node.js — le standalone CLI suffit
    Avoid: Ne PAS supprimer les fichiers CSS existants — coexistence pendant la migration
  </action>
  <verify>
    bash scripts/build_css.sh && ls -la web/static/css/tailwind-output.css
    Le fichier doit exister et contenir du CSS Tailwind
  </verify>
  <done>AC-1 satisfied: Tailwind compile sans erreur, fichier output genere</done>
</task>

<task type="auto">
  <name>Task 2: Creer le template de base Django avec Alpine.js</name>
  <files>web/templates/base.html</files>
  <action>
    Creer web/templates/base.html avec:

    1. Head:
       - Meta charset, viewport
       - Title block: {% block title %}DriftApp{% endblock %}
       - Tailwind output CSS: /static/css/tailwind-output.css
       - Block extra_css pour CSS specifique par page
       - Alpine.js via CDN: https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js (defer)

    2. Body (classes Tailwind avec palette observatory):
       - class="bg-observatory-dark text-text-primary min-h-screen flex flex-col"

    3. Header/Nav (commun a toutes les pages):
       - Logo "DriftApp" + subtitle "Observatoire Ubik"
       - Navigation tabs: Controle (/) | Systeme (/api/health/system/) | Session (/session/)
       - Tab active: highlight avec accent-amber
       - Status indicator slot: {% block status_indicator %}{% endblock %}
       - Conserver le meme look/structure que l'actuel mais en Tailwind

    4. Main content:
       - {% block content %}{% endblock %}

    5. Footer:
       - Version + timestamp
       - {% block footer_extra %}{% endblock %}

    6. Scripts:
       - Alpine.js (deja dans head avec defer)
       - {% block extra_js %}{% endblock %}

    Avoid: Ne PAS ajouter de contenu specifique a une page dans base.html
    Avoid: Ne PAS utiliser de classes CSS custom — uniquement Tailwind utilities
  </action>
  <verify>
    python -c "from django.template.loader import get_template; get_template('base.html')"
    (executer depuis web/ avec DJANGO_SETTINGS_MODULE=driftapp_web.settings)
  </verify>
  <done>AC-2 et AC-3 satisfaits: base.html avec Alpine.js et heritage Django fonctionnel</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Template de base Django avec Tailwind CSS + Alpine.js integres</what-built>
  <how-to-verify>
    1. Run: cd web && python manage.py runserver 0.0.0.0:8000
    2. Creer un template test temporaire qui etend base.html
    3. Verifier: le header/nav s'affiche avec la palette observatory
    4. Verifier: les 3 onglets de navigation sont presents et cliquables
    5. Verifier: Alpine.js fonctionne (tester x-data dans la console)
    6. Confirmer: le dark theme correspond a l'existant
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<boundaries>

## DO NOT CHANGE
- web/templates/dashboard.html (page existante, migree en Phase 2)
- web/templates/system.html (page existante, migree en Phase 3)
- web/templates/session.html (page existante, migree en Phase 4)
- web/static/css/dashboard.css (CSS existant, coexistence)
- web/static/css/system.css (CSS existant, coexistence)
- web/static/css/session.css (CSS existant, coexistence)
- web/static/js/*.js (JS existant, intact)
- core/ (logique metier)
- services/ (motor service)
- web/driftapp_web/settings.py (sauf si ajout STATICFILES minimal)

## SCOPE LIMITS
- Ce plan NE migre PAS les pages existantes — seulement la fondation
- Pas de modification du backend Django (views, urls, APIs)
- Pas de nouveau composant UI — seulement le squelette base.html
- Les pages existantes continuent de fonctionner independamment

</boundaries>

<verification>
Before declaring plan complete:
- [ ] scripts/build_css.sh genere tailwind-output.css sans erreur
- [ ] tailwind.config.js contient toute la palette observatory
- [ ] base.html charge Tailwind CSS + Alpine.js
- [ ] base.html a les blocks: title, content, extra_css, extra_js, status_indicator
- [ ] Le serveur Django demarre sans erreur
- [ ] Les pages existantes (dashboard, system, session) fonctionnent toujours
- [ ] All acceptance criteria met
</verification>

<success_criteria>
- Tailwind CSS compile et genere le fichier output
- Alpine.js est charge et fonctionnel
- base.html est utilisable avec {% extends "base.html" %}
- Palette observatory fidele a l'existant dans tailwind.config.js
- Zero regression sur les pages existantes
</success_criteria>

<output>
After completion, create `.paul/phases/01-foundation-stack-setup/01-01-SUMMARY.md`
</output>
