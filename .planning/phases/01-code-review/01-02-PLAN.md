---
phase: 01-code-review
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/01-code-review/reports/solid-report.md
  - pyproject.toml
autonomous: true

must_haves:
  truths:
    - "Les fonctions/classes avec complexite elevee (grade C+) sont identifiees"
    - "Les violations SRP potentielles ont une severite assignee"
    - "Le rapport couvre tous les modules de core/ et services/"
  artifacts:
    - path: ".planning/phases/01-code-review/reports/solid-report.md"
      provides: "Rapport SOLID avec metriques de complexite"
      contains: "| Module | Function |"
  key_links:
    - from: "radon cc output"
      to: "solid-report.md"
      via: "analyse manuelle SRP"
      pattern: "complexity|grade"
---

<objective>
Analyser l'adherence aux principes SOLID en utilisant radon pour les metriques de complexite et une revue manuelle pour les autres principes.

Purpose: REVIEW-02 exige de verifier SOLID dans core/. Ce plan utilise la complexite cyclomatique comme proxy pour SRP et ajoute une analyse manuelle des violations OCP/DIP observables.
Output: .planning/phases/01-code-review/reports/solid-report.md
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-code-review/01-RESEARCH.md

# Key modules to analyze
@core/hardware/moteur.py
@core/hardware/feedback_controller.py
@core/hardware/acceleration_ramp.py
@core/tracking/tracker.py
@core/tracking/adaptive_tracking.py
@services/motor_service.py
@services/command_handlers.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Installer radon et scanner la complexite</name>
  <files>pyproject.toml</files>
  <action>
1. Ajouter radon aux dependances dev si pas present:
   ```bash
   cd /home/jp/PythonProject/Dome_web_v4_6
   uv add --dev radon
   ```

2. Executer radon pour la complexite cyclomatique sur core/ et services/:
   ```bash
   uv run radon cc core/ services/ -a -s --show-complexity
   ```
   Option -a = moyenne, -s = trier par complexite

3. Generer le rapport de maintenabilite:
   ```bash
   uv run radon mi core/ services/ -s
   ```

4. Identifier toutes les fonctions grade C ou pire (complexite >= 11)

Les thresholds de la recherche:
- A (1-5): Bon
- B (6-10): Acceptable
- C (11-20): A revoir
- D (21-30): Refactoring recommande
- E/F (31+): Urgent
  </action>
  <verify>radon execute et produit des metriques pour tous les fichiers .py</verify>
  <done>Metriques de complexite capturees pour analyse</done>
</task>

<task type="auto">
  <name>Task 2: Analyser SOLID et produire le rapport</name>
  <files>.planning/phases/01-code-review/reports/solid-report.md</files>
  <action>
1. **Analyser SRP via complexite:**
   Pour chaque fonction grade C+, evaluer si la complexite vient de:
   - Logique inherente au hardware (acceptable)
   - Multiples responsabilites melangees (violation SRP)

2. **Analyser OCP manuellement:**
   Chercher des patterns qui violent Open/Closed:
   - if/elif/else sur des types d'objets
   - Switch statements sur des enums croissants
   - Fonctions qui necessitent modification pour extension

3. **Analyser DIP manuellement:**
   Chercher des couplages forts:
   - Import direct de classes concretes vs abstractions
   - Instanciation directe vs injection de dependance

4. **Structure du rapport:**
```markdown
# SOLID Principles Report

## Summary
- Total functions analyzed: X
- Grade C+ (complexity >= 11): Y
- Potential SRP violations: Z
- Other SOLID concerns: N

## Complexity Analysis (SRP Proxy)

### Grade D/E/F (Urgent - complexity >= 21)
| Module | Function | CC | Line Count | Recommendation |
|--------|----------|----|-----------|-----------------|

### Grade C (Review - complexity 11-20)
| Module | Function | CC | Legitimate? | Notes |
|--------|----------|----|-------------|-------|

## Other SOLID Observations

### OCP Concerns
[List of switch/if-chains that may need refactoring]

### DIP Concerns
[List of tight couplings]

## Recommendations by Severity

### Critical (must fix)
...

### Medium (should fix)
...

### Low (nice to have)
...
```

5. Pour les fichiers hardware (moteur.py, feedback_controller.py), noter si la complexite est inherente au domaine.
  </action>
  <verify>Le rapport contient toutes les fonctions grade C+ avec analyse</verify>
  <done>solid-report.md complet avec severites et recommandations</done>
</task>

</tasks>

<verification>
- [ ] radon installe et fonctionne
- [ ] Toutes les fonctions de core/ et services/ sont scannees
- [ ] Les fonctions grade C+ sont listees avec ligne et complexite
- [ ] Une analyse SRP est fournie pour chaque fonction complexe
- [ ] Les recommandations sont priorisees par severite
</verification>

<success_criteria>
1. solid-report.md existe avec tableaux structures
2. Toutes les fonctions complexite >= 11 sont documentees
3. Chaque violation potentielle a une severite (Critical/Medium/Low)
4. Les cas de complexite legitime (hardware) sont justifies
</success_criteria>

<output>
After completion, create `.planning/phases/01-code-review/01-02-SUMMARY.md`
</output>
